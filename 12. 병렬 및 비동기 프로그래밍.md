# 12. ë³‘ë ¬ ë° ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°

## `threading` ëª¨ë“ˆì„ ì´ìš©í•œ ë©€í‹°ìŠ¤ë ˆë”©

### âœ… 1. ëª¨ë“ˆ ì„í¬íŠ¸ ë° ê°œìš”

```
import threading
```

Pythonì˜ `threading` ëª¨ë“ˆì€ **ê³ ìˆ˜ì¤€ì˜ ìŠ¤ë ˆë“œ API**ë¥¼ ì œê³µí•˜ë©°, `Thread` í´ë˜ìŠ¤, `Lock`, `Event`, `Semaphore` ë“±ì˜ ë™ê¸°í™” ë„êµ¬ë„ í•¨ê»˜ í¬í•¨ë˜ì–´ ìˆë‹¤.

### ğŸ§ª 2. ê¸°ë³¸ ì‚¬ìš©ë²•: `Thread` í´ë˜ìŠ¤

#### í•¨ìˆ˜ ê¸°ë°˜ ìŠ¤ë ˆë“œ

```
import threading
import time

def worker():
    print("ìŠ¤ë ˆë“œ ì‹œì‘")
    time.sleep(2)
    print("ìŠ¤ë ˆë“œ ì¢…ë£Œ")

t = threading.Thread(target=worker)
t.start()
t.join()  # ë©”ì¸ ìŠ¤ë ˆë“œëŠ” ì´ ìŠ¤ë ˆë“œê°€ ëë‚  ë•Œê¹Œì§€ ëŒ€ê¸°
```

#### í´ë˜ìŠ¤ ê¸°ë°˜ ìŠ¤ë ˆë“œ

```
class MyThread(threading.Thread):
    def run(self):
        print("MyThread ì‹¤í–‰ ì¤‘")

t = MyThread()
t.start()
t.join()
```

### ğŸ” 3. ì—¬ëŸ¬ ìŠ¤ë ˆë“œ ì‹¤í–‰

```
for i in range(5):
    t = threading.Thread(target=worker)
    t.start()
```

### ğŸ§± 4. ë™ê¸°í™” ê¸°ë²•

#### 4.1 `Lock` (ë®¤í…ìŠ¤)

```
lock = threading.Lock()

def safe_worker():
    with lock:
        # ì„ê³„ êµ¬ì—­ (ê³µìœ  ìì› ì ‘ê·¼)
        print(threading.current_thread().name, "ì‘ì—… ì¤‘")

threads = [threading.Thread(target=safe_worker) for _ in range(3)]
for t in threads:
    t.start()
```

- í•œ ë²ˆì— **í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ** `with lock:` ë‚´ë¶€ ì½”ë“œ ì‹¤í–‰ ê°€ëŠ¥

#### 4.2 `RLock` (ì¬ì§„ì… ê°€ëŠ¥ ë½)

- ë™ì¼ ìŠ¤ë ˆë“œê°€ ì—¬ëŸ¬ ë²ˆ ë½ì„ íšë“í•  ìˆ˜ ìˆë„ë¡ í—ˆìš©
- ë°ë“œë½ ë°©ì§€ë¥¼ ìœ„í•´ í•„ìš”í•  ë•Œ ì‚¬ìš©

### ğŸ§® 5. ì£¼ìš” ìŠ¤ë ˆë“œ ì •ë³´

```
threading.current_thread().name
threading.active_count()
threading.enumerate()
```

### â²ï¸ 6. `Timer` ê°ì²´ (ì§€ì—° ì‹¤í–‰)

```
from threading import Timer

def delayed():
    print("3ì´ˆ í›„ ì‹¤í–‰")

t = Timer(3.0, delayed)
t.start()
```

### â›” 7. ìŠ¤ë ˆë“œ ì¢…ë£Œ ê´€ë¦¬

- Pythonì—ì„œëŠ” ìŠ¤ë ˆë“œë¥¼ **ê°•ì œ ì¢…ë£Œí•  ìˆ˜ ìˆëŠ” í‘œì¤€ APIê°€ ì—†ìŒ**
- ì¼ë°˜ì ìœ¼ë¡œëŠ” **flag ë˜ëŠ” Event ê°ì²´ë¥¼ í†µí•´ ì¢…ë£Œ ì‹ í˜¸ë¥¼ ì „ë‹¬**í•¨

```
stop_event = threading.Event()

def loop_worker():
    while not stop_event.is_set():
        print("ì‘ì—… ì¤‘...")
        time.sleep(1)

t = threading.Thread(target=loop_worker)
t.start()

time.sleep(5)
stop_event.set()
```

### âš ï¸ 8. GIL (Global Interpreter Lock)

- Pythonì˜ CPython êµ¬í˜„ì—ì„œëŠ” GILì´ ì¡´ì¬
- **CPU-bound ì‘ì—…ì€ ë©€í‹°ìŠ¤ë ˆë”©ìœ¼ë¡œ íš¨ê³¼ì ì´ì§€ ì•ŠìŒ**
- **I/O-bound ì‘ì—…(íŒŒì¼, ì†Œì¼“ ë“±)** ì—ì„œ ìœ ìš©
- ë³‘ë ¬ CPU ì‘ì—…ì€ `multiprocessing` ì¶”ì²œ

### ğŸ“Œ ìš”ì•½

| ê¸°ëŠ¥                 | ì„¤ëª…                       |
| -------------------- | -------------------------- |
| `Thread(target=...)` | ìƒˆë¡œìš´ ìŠ¤ë ˆë“œ ì‹¤í–‰         |
| `.start()`           | ìŠ¤ë ˆë“œ ì‹œì‘                |
| `.join()`            | ìŠ¤ë ˆë“œ ì¢…ë£Œê¹Œì§€ ëŒ€ê¸°       |
| `Lock` / `RLock`     | ê³µìœ  ìì› ë™ê¸°í™”           |
| `Event`              | ìŠ¤ë ˆë“œ ê°„ ì‹ í˜¸ ì „ë‹¬        |
| `Timer`              | ì¼ì • ì‹œê°„ í›„ í•¨ìˆ˜ ì‹¤í–‰     |
| `current_thread()`   | í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œ í™•ì¸ |

### âœ… ì‹¤ì „ íŒ

- íŒŒì¼ ë‹¤ìš´ë¡œë“œ, ì›¹ í¬ë¡¤ë§ ë“± I/O ì‘ì—…ì— ìœ ë¦¬
- ìŠ¤ë ˆë“œ ìˆ˜ê°€ ë§ì•„ì§€ë©´ **ìŠ¤ì¼€ì¤„ë§ ë° ë½ ì¶©ëŒ**ì— ì£¼ì˜
- **GIL íšŒí”¼**ê°€ í•„ìš”í•  ê²½ìš° `multiprocessing`, `asyncio` ê²€í† 

## `multiprocessing` ëª¨ë“ˆì„ ì´ìš©í•œ ë©€í‹°í”„ë¡œì„¸ì‹±

`multiprocessing` ëª¨ë“ˆì€ Pythonì—ì„œ **í”„ë¡œì„¸ìŠ¤ ê¸°ë°˜ ë³‘ë ¬ ì²˜ë¦¬**ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” í‘œì¤€ ëª¨ë“ˆë¡œ,
 **GIL(Global Interpreter Lock)** ì˜ ì œì•½ ì—†ì´ **CPU-bound ì‘ì—…**ì„ ë³‘ë ¬í™”í•  ìˆ˜ ìˆë‹¤.

### âœ… 1. ê¸°ë³¸ ê°œë…

- `threading`: í•œ í”„ë¡œì„¸ìŠ¤ ë‚´ ìŠ¤ë ˆë“œ ë³‘ë ¬ â†’ **GILë¡œ ë³‘ëª©**
- `multiprocessing`: ì—¬ëŸ¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ **ì§„ì§œ ë³‘ë ¬ ì²˜ë¦¬**

### ğŸ§ª 2. ê°„ë‹¨í•œ ì‚¬ìš© ì˜ˆ (`Process` í´ë˜ìŠ¤)

```
from multiprocessing import Process

def worker(n):
    print(f"ì‘ì—… {n} ì‹œì‘")

if __name__ == "__main__":
    p = Process(target=worker, args=(1,))
    p.start()
    p.join()
```

- `start()`: í”„ë¡œì„¸ìŠ¤ ì‹œì‘
- `join()`: ë©”ì¸ í”„ë¡œì„¸ìŠ¤ê°€ í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œê¹Œì§€ ëŒ€ê¸°

> ğŸ” Windowsì—ì„œëŠ” `if __name__ == "__main__":` ë³´í˜¸ìê°€ í•„ìˆ˜ë‹¤.

### ğŸ” 3. ë‹¤ì¤‘ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰

```
processes = []
for i in range(5):
    p = Process(target=worker, args=(i,))
    processes.append(p)
    p.start()

for p in processes:
    p.join()
```

### ğŸ§± 4. ê³µìœ  ìì› ë° ë°ì´í„° ì „ì†¡

#### 4.1 `Queue`ë¥¼ ì´ìš©í•œ ë°ì´í„° êµí™˜

```
from multiprocessing import Process, Queue

def producer(q):
    q.put("ë°ì´í„°")

def consumer(q):
    print(q.get())

if __name__ == "__main__":
    q = Queue()
    Process(target=producer, args=(q,)).start()
    Process(target=consumer, args=(q,)).start()
```

#### 4.2 `Value`, `Array`ë¥¼ ì´ìš©í•œ ê³µìœ  ë©”ëª¨ë¦¬

```
from multiprocessing import Value

def increment(val):
    with val.get_lock():
        val.value += 1

if __name__ == "__main__":
    counter = Value('i', 0)  # 'i' = int
    processes = [Process(target=increment, args=(counter,)) for _ in range(10)]
    for p in processes:
        p.start()
    for p in processes:
        p.join()

    print("ìµœì¢… ê°’:", counter.value)
```

### âš™ï¸ 5. `Pool`ì„ ì´ìš©í•œ ë³‘ë ¬ ì²˜ë¦¬

```
from multiprocessing import Pool

def square(x):
    return x * x

if __name__ == "__main__":
    with Pool(processes=4) as pool:
        result = pool.map(square, [1, 2, 3, 4])
        print(result)
```

| ë©”ì„œë“œ                | ì„¤ëª…                  |
| --------------------- | --------------------- |
| `map(func, iterable)` | ê²°ê³¼ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜  |
| `apply(func, args)`   | ë‹¨ì¼ ê°’ ë°˜í™˜          |
| `starmap()`           | íŠœí”Œ ì¸ì í’€ì–´ì„œ ì „ë‹¬ |

### â²ï¸ 6. `Process` vs `Pool`

| í•­ëª©        | `Process`              | `Pool`                           |
| ----------- | ---------------------- | -------------------------------- |
| ê°œë³„ ì œì–´   | âœ… ììœ ë¡œì›€             | âŒ ì œí•œì                          |
| ì½”ë“œ ê°„ê²°ì„± | âŒ ë°˜ë³µ í•„ìš”            | âœ… ê°„ê²°í•œ map                     |
| ë°ì´í„° íë¦„ | ìˆ˜ë™ (`Queue`, `Pipe`) | ìë™ ê²°ê³¼ ë°˜í™˜                   |
| ì í•© ìš©ë„   | ë³µì¡í•œ ì‘ì—… íë¦„       | ì¼ê´„ ì‘ì—… ì²˜ë¦¬ (map-reduce êµ¬ì¡°) |

### ğŸ“¦ 7. ì˜ˆì™¸ ì²˜ë¦¬ ë° ì¢…ë£Œ ê°ì§€

```
from multiprocessing import Process
import time

def task():
    raise Exception("ì‹¤íŒ¨!")

if __name__ == "__main__":
    p = Process(target=task)
    p.start()
    p.join()
    print("ì •ìƒ ì¢…ë£Œ:", not p.exitcode)
```

- `p.exitcode != 0` â†’ ë¹„ì •ìƒ ì¢…ë£Œ

### ğŸ§¹ 8. ê¸°íƒ€ ê¸°ëŠ¥

| ê¸°ëŠ¥              | ê°ì²´                                           |
| ----------------- | ---------------------------------------------- |
| ë°ì´í„° íŒŒì´í”„     | `Pipe()`                                       |
| ë½ ë™ê¸°í™”         | `Lock()`, `RLock()`                            |
| ì´ë²¤íŠ¸ í†µì‹        | `Event()`                                      |
| í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ     | `terminate()`                                  |
| ê³µìœ  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | `Manager()` ì‚¬ìš© ê°€ëŠ¥ (`dict`, `list` ê³µìœ  ë“±) |

### ğŸ“Œ ìš”ì•½

| ìš”ì†Œ             | ì„¤ëª…                             |
| ---------------- | -------------------------------- |
| `Process`        | í”„ë¡œì„¸ìŠ¤ ìƒì„± ë° ì‹¤í–‰            |
| `Queue`, `Pipe`  | í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹                  |
| `Value`, `Array` | ê³µìœ  ë³€ìˆ˜                        |
| `Lock`           | ì„ê³„ êµ¬ì—­ ë³´í˜¸                   |
| `Pool`           | ì‘ì—… ë³‘ë ¬ ì²˜ë¦¬                   |
| `Manager`        | ê³ ìˆ˜ì¤€ ê³µìœ  ê°ì²´ (dict, list ë“±) |
| `join()`         | ì¢…ë£Œ ëŒ€ê¸°                        |
| `terminate()`    | ê°•ì œ ì¢…ë£Œ                        |

### ğŸ§  ì‹¤ì „ ì ìš© ì˜ˆ

- ëŒ€ìš©ëŸ‰ ì´ë¯¸ì§€ ì²˜ë¦¬
- ë³‘ë ¬ ì‹œë®¬ë ˆì´ì…˜
- ì›¹ í¬ë¡¤ë§ ë‹¤ì¤‘ í”„ë¡œì„¸ìŠ¤ ë²„ì „
- ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ ë°ì´í„° ì „ì²˜ë¦¬

## `concurrent.futures` ëª¨ë“ˆ

### âœ… 1. ê°œìš”

`concurrent.futures`ëŠ” Python 3.2ë¶€í„° ë„ì…ëœ **í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬**ë¡œ,
 ë³µì¡í•œ ìŠ¤ë ˆë“œ/í”„ë¡œì„¸ìŠ¤ ìƒì„± ì—†ì´ **ë¹„ë™ê¸°ì  ë³‘ë ¬ ì‘ì—…ì„ ì‰½ê²Œ ì‹¤í–‰**í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤.

### ğŸš€ 2. ì£¼ìš” êµ¬ì„±

- `ThreadPoolExecutor`: ìŠ¤ë ˆë“œë¥¼ ì´ìš©í•œ I/O ë³‘ë ¬ ì²˜ë¦¬
- `ProcessPoolExecutor`: í”„ë¡œì„¸ìŠ¤ë¥¼ ì´ìš©í•œ CPU ë³‘ë ¬ ì²˜ë¦¬
- `Future`: ë¹„ë™ê¸° ì‘ì—…ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´

### ğŸ§ª 3. ê¸°ë³¸ ì‚¬ìš© ì˜ˆ

#### ThreadPoolExecutor ì˜ˆì‹œ

```
from concurrent.futures import ThreadPoolExecutor

def task(n):
    return n * n

with ThreadPoolExecutor(max_workers=4) as executor:
    future = executor.submit(task, 10)
    print(future.result())  # ê²°ê³¼: 100
```

#### ProcessPoolExecutor ì˜ˆì‹œ

```
from concurrent.futures import ProcessPoolExecutor

def square(x):
    return x ** 2

with ProcessPoolExecutor() as executor:
    results = list(executor.map(square, [1, 2, 3, 4]))
    print(results)  # [1, 4, 9, 16]
```

### ğŸ“Œ 4. `submit()` vs `map()`

| ë©”ì„œë“œ              | íŠ¹ì§•                                                     |
| ------------------- | -------------------------------------------------------- |
| `submit(fn, *args)` | ë¹„ë™ê¸° ë‹¨ì¼ ì‘ì—… ì‹¤í–‰ â†’ `Future` ë°˜í™˜                    |
| `map(fn, iterable)` | ë°˜ë³µ ê°€ëŠ¥í•œ ì…ë ¥ì— ëŒ€í•´ ë³‘ë ¬ ì²˜ë¦¬ â†’ ê²°ê³¼ ì´í„°ë ˆì´í„° ë°˜í™˜ |
| `as_completed()`    | ë¨¼ì € ì™„ë£Œëœ ì‘ì—…ë¶€í„° ê²°ê³¼ í™•ì¸ ê°€ëŠ¥                      |

### ğŸ” 5. ì—¬ëŸ¬ ì‘ì—… ë³‘ë ¬ ì²˜ë¦¬ (`submit + as_completed`)

```
from concurrent.futures import ThreadPoolExecutor, as_completed

def download(i):
    return f"íŒŒì¼ {i} ì™„ë£Œ"

with ThreadPoolExecutor() as executor:
    futures = [executor.submit(download, i) for i in range(5)]
    for f in as_completed(futures):
        print(f.result())
```

### â²ï¸ 6. íƒ€ì„ì•„ì›ƒ ë° ì˜ˆì™¸ ì²˜ë¦¬

```
from concurrent.futures import TimeoutError

future = executor.submit(task, 10)

try:
    result = future.result(timeout=2)
except TimeoutError:
    print("ì‹œê°„ ì´ˆê³¼ ë°œìƒ")
```

### ğŸ” 7. `Future` ê°ì²´ì˜ ì£¼ìš” ë©”ì„œë“œ

| ë©”ì„œë“œ                  | ì„¤ëª…                          |
| ----------------------- | ----------------------------- |
| `.result(timeout=None)` | ì™„ë£Œ ê²°ê³¼ ë°˜í™˜ ë˜ëŠ” ì˜ˆì™¸ ë°œìƒ |
| `.done()`               | ì™„ë£Œ ì—¬ë¶€                     |
| `.cancel()`             | ì‹¤í–‰ ì „ ì·¨ì†Œ ì‹œë„             |
| `.exception()`          | ì˜ˆì™¸ ê°ì²´ ë°˜í™˜                |

### ğŸ’¡ 8. ThreadPool vs ProcessPool

| í•­ëª©      | ThreadPoolExecutor        | ProcessPoolExecutor       |
| --------- | ------------------------- | ------------------------- |
| ë³‘ë ¬ ë°©ì‹ | ìŠ¤ë ˆë“œ (ë™ì¼ í”„ë¡œì„¸ìŠ¤ ë‚´) | ë³„ë„ í”„ë¡œì„¸ìŠ¤             |
| GIL ì˜í–¥  | ìˆìŒ (I/O-boundì— ì í•©)   | ì—†ìŒ (CPU-boundì— ì í•©)   |
| ì‘ë‹µ ì†ë„ | ë¹ ë¦„ (ê²½ëŸ‰)               | ëŠë¦¼ (í”„ë¡œì„¸ìŠ¤ ìƒì„± ë¹„ìš©) |
| ì˜ˆì™¸ ì „íŒŒ | Futureì— ì €ì¥ë¨           | ë™ì¼                      |

### ğŸ§  9. ë³‘ë ¬ ì „ëµ ìš”ì•½

| ì‘ì—… ìœ í˜•                               | ì ì ˆí•œ Executor       |
| --------------------------------------- | --------------------- |
| ì›¹ ìš”ì²­, íŒŒì¼ I/O, ë°ì´í„°ë² ì´ìŠ¤         | `ThreadPoolExecutor`  |
| ìˆ˜ì¹˜ ê³„ì‚°, ì´ë¯¸ì§€ ì²˜ë¦¬, ê³¼í•™ ì‹œë®¬ë ˆì´ì…˜ | `ProcessPoolExecutor` |

### âœ… 10. ì˜ˆì™¸ ì²˜ë¦¬ ì˜ˆ

```
def fail_task():
    raise ValueError("ì‹¤íŒ¨")

future = executor.submit(fail_task)

try:
    result = future.result()
except Exception as e:
    print("ì˜ˆì™¸ ë°œìƒ:", e)
```

### ğŸ“Œ ìš”ì•½ í…Œì´ë¸”

| ê°œë…             | ì„¤ëª…                                |
| ---------------- | ----------------------------------- |
| `Executor`       | ì‘ì—… ì‹¤í–‰ì (ìŠ¤ë ˆë“œ or í”„ë¡œì„¸ìŠ¤ í’€) |
| `submit()`       | ê°œë³„ ì‘ì—… ì œì¶œ                      |
| `map()`          | ë°˜ë³µ ì²˜ë¦¬ ë³‘ë ¬í™”                    |
| `Future`         | ë¹„ë™ê¸° ê²°ê³¼ ê°ì²´                    |
| `as_completed()` | ì™„ë£Œëœ ìˆœì„œëŒ€ë¡œ ê²°ê³¼ ìˆ˜ì§‘           |
| ì˜ˆì™¸ ì²˜ë¦¬        | `result()` í˜¸ì¶œ ì‹œ ì „íŒŒë¨           |

`concurrent.futures`ëŠ” **ê°„ê²°í•œ ë¬¸ë²• + ê°•ë ¥í•œ ê¸°ëŠ¥**ìœ¼ë¡œ Pythonì—ì„œ **ë³‘ë ¬ í”„ë¡œê·¸ë˜ë°ì˜ ì‚¬ì‹¤ìƒ í‘œì¤€ ì¸í„°í˜ì´ìŠ¤**ì´ë‹¤.

## `asyncio`, `await`, `async def`

### âœ… 1. ê°œìš”

- `asyncio`ëŠ” **ì‹±ê¸€ ìŠ¤ë ˆë“œ, ì‹±ê¸€ í”„ë¡œì„¸ìŠ¤ í™˜ê²½**ì—ì„œ **ë™ì‹œì„±(Concurrency)** ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ **ë¹„ë™ê¸° I/O í”„ë ˆì„ì›Œí¬**ë‹¤.
- ì½”ë£¨í‹´(Coroutine), ì´ë²¤íŠ¸ ë£¨í”„(Event Loop), awaitable ê°ì²´ ë“±ì„ í†µí•´ ë™ì‹œ ì‹¤í–‰ì„ ì§€ì›í•œë‹¤.
- **CPU-bound ì‘ì—…ì´ ì•„ë‹Œ I/O-bound ì‘ì—…** (ex: ë„¤íŠ¸ì›Œí¬, íŒŒì¼, sleep ë“±)ì— ì í•©í•˜ë‹¤.

### ğŸ”§ 2. ì£¼ìš” í‚¤ì›Œë“œ

| í‚¤ì›Œë“œ          | ì„¤ëª…                             |
| --------------- | -------------------------------- |
| `async def`     | ë¹„ë™ê¸° í•¨ìˆ˜ ì •ì˜                 |
| `await`         | ë¹„ë™ê¸° í•¨ìˆ˜/ê°ì²´ì˜ ì™„ë£Œë¥¼ ê¸°ë‹¤ë¦¼ |
| `asyncio.run()` | ì´ë²¤íŠ¸ ë£¨í”„ ì‹œì‘ ë° ì‹¤í–‰         |

### ğŸ“˜ 3. `async def`: ë¹„ë™ê¸° í•¨ìˆ˜ ì •ì˜

```
async def say_hello():
    print("Hello")
```

- `async def`ë¡œ ì •ì˜ëœ í•¨ìˆ˜ëŠ” **ì¼ë°˜ í•¨ìˆ˜ì™€ ë‹¬ë¦¬ ì¦‰ì‹œ ì‹¤í–‰ë˜ì§€ ì•Šê³ , coroutine ê°ì²´ë¥¼ ë°˜í™˜**í•œë‹¤.

### â³ 4. `await`: ì½”ë£¨í‹´ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰

```
import asyncio

async def say_hello():
    await asyncio.sleep(1)
    print("Hello after 1 second")

asyncio.run(say_hello())
```

- `await`ì€ **`awaitable` ê°ì²´** (ì½”ë£¨í‹´, Future ë“±)ì—ë§Œ ì‚¬ìš© ê°€ëŠ¥
- ì‹¤ì œ `sleep(1)` ë™ì•ˆ **ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ë‹¤ë¥¸ ì‘ì—…ì„ ì²˜ë¦¬ ê°€ëŠ¥**

### ğŸ§ª 5. ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰

```
async def task(name):
    await asyncio.sleep(1)
    print(f"{name} ì™„ë£Œ")

async def main():
    await asyncio.gather(
        task("A"),
        task("B"),
        task("C")
    )

asyncio.run(main())
```

- `asyncio.gather()`ëŠ” ì—¬ëŸ¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰í•¨
- `await`ëŠ” ì—¬ì „íˆ ì „ì²´ ì™„ë£Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” êµ¬ì¡°

### ğŸ” 6. ë¬´í•œ ë£¨í”„ & ë³‘ë ¬ ë°˜ë³µ

```
async def worker(n):
    for i in range(3):
        await asyncio.sleep(1)
        print(f"ì‘ì—… {n}: {i}")

async def main():
    tasks = [asyncio.create_task(worker(i)) for i in range(2)]
    await asyncio.gather(*tasks)

asyncio.run(main())
```

- `create_task()`ëŠ” ì½”ë£¨í‹´ì„ ì¦‰ì‹œ **ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰**í•˜ê²Œ ë§Œë“¦
- ë³‘ë ¬ ë°˜ë³µ ì‘ì—…ì— íš¨ê³¼ì 

### ğŸ› ï¸ 7. `asyncio.run()` ë‚´ë¶€ ì‘ë™ ë°©ì‹

```
# ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ìŒ
loop = asyncio.get_event_loop()
loop.run_until_complete(main())
```

- Python 3.7 ì´ìƒì—ì„œëŠ” `asyncio.run()` ì‚¬ìš© ê¶Œì¥
- ì´ë²¤íŠ¸ ë£¨í”„ëŠ” í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ **í•˜ë‚˜ë§Œ ì¡´ì¬í•´ì•¼ í•¨**

### â— 8. ë™ê¸° ì½”ë“œì—ì„œ `await` ì‚¬ìš© ë¶ˆê°€

```
# ë‹¤ìŒì€ ì˜¤ë¥˜ ë°œìƒ:
def bad():
    await asyncio.sleep(1)  # SyntaxError

# ë°˜ë“œì‹œ async def ë‚´ë¶€ì—ì„œë§Œ await ì‚¬ìš© ê°€ëŠ¥
```

### â›” 9. ë™ê¸° í•¨ìˆ˜ í˜¸ì¶œ ì£¼ì˜

- `async` í•¨ìˆ˜ ë‚´ì—ì„œ **ë™ê¸° í•¨ìˆ˜(ì˜ˆ: `time.sleep()`)ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ë©´ ì „ì²´ ë¸”ë¡œí‚¹ë¨**
- ë°˜ë“œì‹œ `await asyncio.sleep()`ì²˜ëŸ¼ ë¹„ë™ê¸° í•¨ìˆ˜ ì‚¬ìš©

### ğŸ“Œ 10. ì£¼ìš” í•¨ìˆ˜ ìš”ì•½

| í•¨ìˆ˜/í‚¤ì›Œë“œ             | ì„¤ëª…                               |
| ----------------------- | ---------------------------------- |
| `async def`             | ì½”ë£¨í‹´ í•¨ìˆ˜ ì •ì˜                   |
| `await`                 | ë¹„ë™ê¸° í•¨ìˆ˜ ì‹¤í–‰ ëŒ€ê¸°              |
| `asyncio.run()`         | ë¹„ë™ê¸° ë£¨í”„ ì‹¤í–‰ (ìµœìƒìœ„ì—ì„œ ì‚¬ìš©) |
| `asyncio.gather()`      | ë³‘ë ¬ ì½”ë£¨í‹´ ì‹¤í–‰                   |
| `asyncio.create_task()` | ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ ë“±ë¡               |
| `asyncio.sleep()`       | ë¹„ë™ê¸° íƒ€ì´ë¨¸ (CPU ì ìœ  ì•ˆí•¨)      |

### âœ… ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì´ í•„ìš”í•œ ê²½ìš°

- ì›¹ ì„œë²„ (FastAPI, aiohttp ë“±)
- ìˆ˜ë§ì€ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ (API í¬ë¡¤ëŸ¬, ì±„íŒ… ì„œë²„)
- íŒŒì¼, ì†Œì¼“, DB I/O ì²˜ë¦¬
- ì´ë²¤íŠ¸ ë£¨í”„ ê¸°ë°˜ GUI (ì˜ˆ: PyQt)

### ğŸ”„ `threading` vs `asyncio` vs `multiprocessing`

| ë¹„êµ í•­ëª©   | threading   | multiprocessing | asyncio                         |
| ----------- | ----------- | --------------- | ------------------------------- |
| ë°©ì‹        | ìŠ¤ë ˆë“œ ë³‘ë ¬ | í”„ë¡œì„¸ìŠ¤ ë³‘ë ¬   | ì´ë²¤íŠ¸ ë£¨í”„                     |
| GIL ì˜í–¥    | ìˆìŒ        | ì—†ìŒ            | ì—†ìŒ                            |
| I/O íš¨ìœ¨    | ì¤‘ê°„        | ë‚®ìŒ            | ë§¤ìš° ë†’ìŒ                       |
| CPU íš¨ìœ¨    | ë‚®ìŒ        | ë†’ìŒ            | ë‚®ìŒ                            |
| ì½”ë“œ ë³µì¡ë„ | ë³´í†µ        | ë†’ìŒ            | ë‚®ìŒ (async ì½”ë“œì— ìµìˆ™í•  ê²½ìš°) |

## í, ë½ ë“± ë™ê¸°í™” ê°ì²´

Pythonì˜ í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë©€í‹°ìŠ¤ë ˆë“œ/ë©€í‹°í”„ë¡œì„¸ìŠ¤ í™˜ê²½ì—ì„œ **ë°ì´í„°ì˜ ì¼ê´€ì„± ìœ ì§€ì™€ ê²½ìŸ ì¡°ê±´ ë°©ì§€**ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ë™ê¸°í™” ê°ì²´ë¥¼ ì œê³µí•œë‹¤.

### ğŸ§± 1. Lock (`threading.Lock`)

#### ìš©ë„: **ì„ê³„ êµ¬ì—­ ë³´í˜¸ (Mutual Exclusion)**

```
import threading

lock = threading.Lock()

def worker():
    with lock:
        # ê³µìœ  ìì› ì ‘ê·¼
        print("ì‘ì—… ì¤‘")

# ë˜ëŠ” ìˆ˜ë™ ë°©ì‹
lock.acquire()
# ...
lock.release()
```

- **í•œ ë²ˆì— í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ë½ì„ íšë“í•  ìˆ˜ ìˆìŒ**
- acquire â†’ ì‘ì—… â†’ release ìˆœì„œ

### ğŸ” 2. RLock (Reentrant Lock)

### ìš©ë„: **ë™ì¼ ìŠ¤ë ˆë“œì—ì„œ ì—¬ëŸ¬ ë²ˆ ë½ì„ íšë“ ê°€ëŠ¥**

```
lock = threading.RLock()

def recursive():
    with lock:
        # ì¬ê·€ ë˜ëŠ” ì¤‘ì²© ì§„ì… ì‹œ deadlock ë°©ì§€
        recursive()
```

- `Lock`ì€ í•œ ë²ˆë§Œ íšë“ ê°€ëŠ¥
- `RLock`ì€ íšŸìˆ˜ ëˆ„ì  í›„ ë™ì¼ ìˆ˜ ë§Œí¼ í•´ì œ

### ğŸš¦ 3. Semaphore / BoundedSemaphore

#### ìš©ë„: **ë™ì‹œ ì ‘ê·¼ í—ˆìš© ê°œìˆ˜ ì œí•œ**

```
sem = threading.Semaphore(3)  # ìµœëŒ€ 3ê°œ ìŠ¤ë ˆë“œ ë™ì‹œ ì ‘ê·¼

def limited():
    with sem:
        print("ë™ì‹œì„± ì œí•œëœ ì‘ì—…")
```

- ì£¼ë¡œ **ë¦¬ì†ŒìŠ¤ ì œí•œ, API í˜¸ì¶œ ì œí•œ**ì— ì‚¬ìš©
- `BoundedSemaphore`: release íšŸìˆ˜ê°€ acquireë³´ë‹¤ ë§ìœ¼ë©´ ì—ëŸ¬

### ğŸ“¶ 4. Event (ì´ë²¤íŠ¸ ì‹ í˜¸)

#### ìš©ë„: **ìŠ¤ë ˆë“œ ê°„ ì‹ í˜¸ ì „ë‹¬**

```
event = threading.Event()

def waiter():
    print("ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...")
    event.wait()  # ì‹ í˜¸ ì˜¤ê¸° ì „ê¹Œì§€ ë¸”ë¡
    print("ì´ë²¤íŠ¸ ê°ì§€!")

def setter():
    event.set()  # ëª¨ë“  wait() ì¤‘ì¸ ìŠ¤ë ˆë“œ ê¹¨ì›€
```

- `.set()`, `.clear()`, `.is_set()` ë©”ì„œë“œë¡œ ìƒíƒœ ì œì–´
- ì´ë²¤íŠ¸ ê¸°ë°˜ ìƒíƒœ ì „íŒŒì— ì í•©

### ğŸ”„ 5. Condition (ì¡°ê±´ ë³€ìˆ˜)

#### ìš©ë„: **ìƒíƒœ ë³€í™”ì— ë”°ë¥¸ wait-notify ì œì–´**

```
condition = threading.Condition()
shared_data = []

def consumer():
    with condition:
        while not shared_data:
            condition.wait()
        item = shared_data.pop()
        print("ì†Œë¹„:", item)

def producer():
    with condition:
        shared_data.append("item")
        condition.notify()  # ëŒ€ê¸° ì¤‘ì¸ ìŠ¤ë ˆë“œ ì¤‘ í•˜ë‚˜ ê¹¨ì›€
```

- `.wait()` â†’ ì¡°ê±´ ëŒ€ê¸°
- `.notify()` / `.notify_all()` â†’ ì¡°ê±´ í•´ì œ

### ğŸ“¦ 6. Queue (ìŠ¤ë ˆë“œ ì•ˆì „)

#### ìš©ë„: **ìƒì‚°ì-ì†Œë¹„ì ëª¨ë¸ êµ¬í˜„ì— ìµœì í™”ëœ ë™ê¸°í™” í**

```
import queue
import threading

q = queue.Queue()

def producer():
    for i in range(5):
        q.put(i)

def consumer():
    while True:
        item = q.get()
        print("ì†Œë¹„:", item)
        q.task_done()
```

- **FIFO**, `LifoQueue`, `PriorityQueue` ë“± ì œê³µ
- `.put()`, `.get()`, `.task_done()` ë©”ì„œë“œ ì‚¬ìš©
- ë‚´ë¶€ì ìœ¼ë¡œ Lockìœ¼ë¡œ **ìŠ¤ë ˆë“œ ì•ˆì „** ë³´ì¥

### ğŸ§  ë©€í‹°í”„ë¡œì„¸ì‹±ìš© ë™ê¸°í™” ê°ì²´

`multiprocessing` ëª¨ë“ˆì€ ë¹„ìŠ·í•œ APIë¥¼ **í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ ìš©**ìœ¼ë¡œ ì œê³µí•œë‹¤.

| ê¸°ëŠ¥      | ê°ì²´                          |
| --------- | ----------------------------- |
| ë½        | `multiprocessing.Lock()`      |
| ì„¸ë§ˆí¬ì–´  | `multiprocessing.Semaphore()` |
| ì´ë²¤íŠ¸    | `multiprocessing.Event()`     |
| í        | `multiprocessing.Queue()`     |
| ê³µìœ  ë³€ìˆ˜ | `Value`, `Array`, `Manager()` |

### âœ… ìš”ì•½ í…Œì´ë¸”

| ê°ì²´        | ìŠ¤ë ˆë“œ/í”„ë¡œì„¸ìŠ¤ | ì—­í•                            |
| ----------- | --------------- | ------------------------------ |
| `Lock`      | ë‘˜ ë‹¤           | ë‹¨ì¼ ìŠ¤ë ˆë“œ/í”„ë¡œì„¸ìŠ¤ ì§„ì… ë³´í˜¸ |
| `RLock`     | ë‘˜ ë‹¤           | ì¬ì§„ì… í—ˆìš© ë½                 |
| `Semaphore` | ë‘˜ ë‹¤           | ë™ì‹œì— nê°œ í—ˆìš©                |
| `Event`     | ë‘˜ ë‹¤           | ìƒíƒœ ê¸°ë°˜ ì‹ í˜¸ ì „ë‹¬            |
| `Condition` | ë‘˜ ë‹¤           | ë³µì¡í•œ wait-notify ì œì–´        |
| `Queue`     | ë‘˜ ë‹¤           | ì•ˆì „í•œ ìƒì‚°ì-ì†Œë¹„ì í        |

### ğŸ“Œ ì‹¤ì „ í™œìš© íŒ

- `Lock`, `Queue` â†’ ê³µìœ  ë°ì´í„° ì ‘ê·¼ ì œì–´
- `Semaphore` â†’ ë™ì‹œì„± ì œí•œ
- `Event` â†’ í”„ë¡œì„¸ìŠ¤/ìŠ¤ë ˆë“œ ê°„ ë™ê¸°í™”
- `Condition` â†’ ë°ì´í„° ì¤€ë¹„ ì™„ë£Œ ì‹œì  í†µì§€
- `Manager().Queue()` â†’ ë©€í‹°í”„ë¡œì„¸ì‹± í™˜ê²½ì—ì„œ ê³µìœ  í